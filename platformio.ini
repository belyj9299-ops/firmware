[platformio]
default_envs = esp32-s3-devkitc-1

[env:esp32-s3-devkitc-1]
; ФИКС 1: Фиксируем версию платформы, чтобы избежать ошибки esp32-hal-periman.h
platform = espressif32 @ 6.7.0
board = esp32s3box ; Используем более подходящий профиль для S3
framework = arduino
monitor_speed = 115200

build_flags =
    -Os
    ; ФИКС 2: Игнорируем встроенные настройки TFT_eSPI
    -D USER_SETUP_LOADED=1
    -D BRUCE_TFT_LOVYANGFX=1
    -D LGFX_USE_V1=1
    
    ; ФИКС 3: Принудительно отменяем (undefine) старые пины, если они мешают
    -U TFT_CS
    -U TFT_DC
    -U TFT_RST
    -U TFT_MOSI
    -U TFT_SCLK
    
    ; Твои пины (D5, D2, D4)
    -D TFT_MISO=19
    -D TFT_MOSI=23
    -D TFT_SCLK=18
    -D TFT_CS=5        
    -D TFT_DC=2        
    -D TFT_RST=4       
    
    -D DISABLE_ALL_LIBRARY_WARNINGS
    -D ARDUINO_USB_CDC_ON_BOOT=1
    -D BOARD_HAS_PSRAM=0

lib_deps =
    lovyan03/LovyanGFX @ ^1.1.12
